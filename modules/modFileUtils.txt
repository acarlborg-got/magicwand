

Option Explicit

' Returnerar basnamnet utan filändelsen från en filväg
Function GetBaseName(filePath As String) As String
    Dim fso As Object
    Set fso = CreateObject("Scripting.FileSystemObject")
    GetBaseName = fso.GetBaseName(filePath)
End Function

' Returnerar mappens namn från en fullständig sökväg
Function GetFolderName(path As String) As String
    Dim fso As Object
    Set fso = CreateObject("Scripting.FileSystemObject")
    GetFolderName = fso.GetParentFolderName(path)
End Function

' Skapar mappen om den inte redan finns
Sub EnsureFolderExists(folderPath As String)
    Dim fso As Object
    Set fso = CreateObject("Scripting.FileSystemObject")
    If Not fso.FolderExists(folderPath) Then
        fso.CreateFolder folderPath
    End If
End Sub

' Returns sanitized username for per-user logs
Public Function GetUserIdentifier() As String
    Dim username As String
    On Error Resume Next
    username = Environ("UserName")
    If username = "" Then username = Application.UserName
    username = Replace(username, " ", "_")
    username = Replace(username, "@", "_")
    username = Replace(username, "\\", "_")
    GetUserIdentifier = username
End Function

' Skapar en loggfil och returnerar filnumret
Public Function CreateLogFile(logPath As String) As Integer
    Dim fileNum As Integer
    fileNum = FreeFile
    Open logPath For Output As #fileNum
    CreateLogFile = fileNum
End Function

' Lägger till en rad text i en loggfil
Sub AppendToLog(fileNum As Integer, message As String)
    Print #fileNum, Now & " - " & message
End Sub

